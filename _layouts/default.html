<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
  <script>
    document.documentElement.classList.remove('no-js');
    document.documentElement.classList.add('js');
  </script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{ page.title | default: "Golden Trowel Project" }}</title>

  <!-- Canonical URL for SEO -->
  <link rel="canonical" href="{{ page.url | absolute_url }}">

  <style>

.wave-btn {
  position:absolute;
  display:flex;
  align-items:center;
  justify-content:center;
  width:70px; height:70px;
  border-radius:50%;
  background:#ffdc8f;
  font-weight:bold;
  font-size:clamp(.8rem, 1vw, 1rem);
  color:#000;
  text-align:center;
  line-height:1.2;
  box-shadow:0 2px 6px rgba(0,0,0,.2);
  cursor:pointer;
  transition:background .3s, color .3s;
}

.wave-btn:hover {
  background:#633747;
  color:#fff;
}

/* remove old label-below effect */
.wave-btn::after { content:none; }

    /* ---------- Base ---------- */
    *, *::before, *::after { box-sizing: border-box; }
    body { font-family: Calibri, sans-serif; background:#eae6df; margin:0; }
    img, svg, video { max-width:100%; height:auto; display:block; }
    h1{ font-size:clamp(1.8rem,5.5vw,2.4rem); margin:.2em 0; }
    h2{ font-size:clamp(1.4rem,4.5vw,2rem);  margin:.3em 0 .4em; }
    h3{ font-size:clamp(1.2rem,4vw,1.6rem);  margin:.25em 0 .4em; }
    p { font-size:clamp(1rem,2.8vw,1.2rem);  margin:.6em 0; }
    main{ width:min(100%,1100px); margin-inline:auto; padding:clamp(16px,4vw,28px); text-align:center; }

    /* ---------- Header ---------- */
    header{
      background:#633747; color:#fff;
      padding: clamp(0.8em, 3vw, 1.2em);
    }
    .header-content{
      display:flex; align-items:center; justify-content:center; gap:1em;
      max-width:1100px; margin:0 auto;
    }
    .header-content img{ width:130px; border-radius:12px; }
    .header-text{ text-align:left; }
    .header-text p{ margin:.3em 0 0; color:#ffdc8f; }

    /* ---------- Wave + Circle Nav (desktop) ---------- */
    .wave-nav{
      position:relative; background:#633747; height:clamp(120px,22vw,220px);
      overflow:hidden; display:none;   /* hidden on mobile, shown â‰¥900px */
    }
.wave-nav{
  height: clamp(110px, 18vw, 180px); /* was 120/22vw/220 */
}

    .wave-nav .wave{ width:100%; height:100%; display:block; }

    .circle-nav{ position:absolute; inset:0; pointer-events:none; }
    .circle-btn{
      --size: clamp(54px, 7vw, 76px);
      position:absolute; width:var(--size); height:var(--size);
      border-radius:50%; border:none; cursor:pointer; pointer-events:auto;
      background:#ffdc8f; color:#000; font-weight:800;
      box-shadow:0 6px 18px rgba(0,0,0,.18);
      transition: transform .15s ease, background .15s ease, color .15s ease;
    }
    .circle-btn:hover{ transform:translateY(-2px); background:#633747; color:#fff; }
    .circle-btn:focus-visible{ outline:3px solid #e8a084; outline-offset:3px; }
    .circle-btn::after{
      content: attr(data-label);
      position:absolute; left:50%; transform:translateX(-50%);
      bottom: -1.9em; white-space:nowrap; font-size:.95rem; font-weight:800; color:#000;
    }

    /* ---------- Sticky dropdown bar (mobile / fallback) ---------- */
    .nav-scroller{
      width:100%; background:#e8a084; position:sticky; top:0; z-index:2000;
      overflow-x:hidden; overflow-y:visible !important;
    }
    .main-nav{
      background:transparent; display:grid;
      grid-template-columns: repeat(5, minmax(60px, 220px));
      justify-content:center; align-items:stretch;
      gap: clamp(6px, .6vw, 6px);
      padding: clamp(6px, 1vw, 10px);
      width:min(100%,1200px); margin-inline:auto;
    }
    .main-nav a, .dropdown-content a{ text-decoration:none; color:inherit; }
    .dropdown{ position:relative; min-width:0; }
    .dropdown > a{
      display:flex; align-items:center; justify-content:center; text-align:center;
      padding: clamp(6px, 1vw, 6px) clamp(6px, 1vw, 10px);
      font-size: clamp(.9rem, 1vw, 1rem);
      font-weight:bold; color:#000; border-radius:6px; line-height:1.4;
      white-space: normal; min-height:44px;
    }
    .dropdown:hover > a, .dropdown > a:focus-visible{ background:#633747; color:#fff; }
    .dropdown-content{
      display:none; position:absolute; top:100%; left:50%; transform:translateX(-50%);
      background:#e8a084; font-weight:bold; font-size:clamp(.9rem,.7vw,1rem);
      padding:.25em 0; border-radius:6px; min-width:max(220px, 100%);
      max-width:min(90vw, 30rem); z-index:10; box-shadow:0 8px 24px rgba(0,0,0,.18);
    }
    .dropdown-content a{ display:block; padding:.55em .7em; line-height:2; border-radius:6px; color:#000; }
    .dropdown-content a:hover, .dropdown-content a:focus-visible{ background:#633747; color:#fff; }

    /* mobile nav scroll + grid adjustments */
    :root { --nav-tile-w: 120px; }
    @media (max-width:900px){
      .nav-scroller{ overflow-x:auto; -webkit-overflow-scrolling:touch; scrollbar-width:none; }
      .nav-scroller::-webkit-scrollbar{ width:0; height:0; }
      .main-nav{ grid-template-columns:none !important; grid-auto-flow:column; grid-auto-columns:var(--nav-tile-w); width:max-content; justify-content:start; }
      .dropdown > a{ width:100%; }
    }

    /* show wave + circle nav on desktop; hide bar */
    @media (min-width:900px){
      .wave-nav{ display:block; }
      .nav-scroller{ display:none; }
    }

    /* home-page cards etc (unchanged) */
    {% if page.is_homepage %}
      .main-section{ padding-block: clamp(10px, 2vw, 18px); }
      .main-section > .docs-container{ margin: clamp(6px, 1vw, 10px) auto; }
      .docs-container{ width:min(100%,1000px); padding:clamp(12px,2.2vw,18px); border-radius:16px; }
      .docs-container.prevalence{ background:#ffdc8f; }
      .docs-container.safety-plan{ background:#633747; color:#fff; }
      .docs-container.safety-plan h2{ margin:.2em 0 .3em; }
      .docs-container.safety-plan p{ margin:.2em auto .8em; max-width:72ch; }
      .doc-links{ display:grid; gap:clamp(10px,2vw,18px); grid-template-columns:1fr; justify-items:center; margin-top:.5em; }
      @media (min-width:720px){ .doc-links{ grid-template-columns:repeat(2,1fr);} }
      @media (min-width:1024px){ .doc-links{ grid-template-columns:repeat(2,1fr);} }
      .doc-card{ width:100%; max-width:420px; background:#e8a084; color:#000; border-radius:10px;
                 padding:clamp(12px,2.2vw,18px); box-shadow:0 2px 6px rgba(0,0,0,.08); text-align:center; display:flex; flex-direction:column; gap:.6em; }
      .doc-card a{ margin-top:auto; align-self:center; background:#633747; color:#fff; text-decoration:none; padding:.5em 1em; border-radius:6px; display:inline-block; }
      .doc-card a:hover{ background:#ffdc8f; color:#000; }
    {% endif %}
  </style>
</head>

<body>
  <!-- Header -->
  <header>
    <div class="header-content">
      <img
        src="{{ '/assets/img/IMG_3241.PNG' | absolute_url }}?v={{ site.time | date: '%s' }}"
        alt="Logo for the Golden Trowel Project: a stylized golden trowel and skull emblem encircled by text."
        loading="lazy" decoding="async" fetchpriority="low">
      <div class="header-text">
        <h1>Recognizing power. Reclaiming safety.</h1>
        <p>Practical tools. Powerful boundaries. Safer fieldwork.</p>
      </div>
    </div>
  </header>

  <!-- Wave + Circle Nav (desktop) -->
  <section class="wave-nav" aria-label="Primary decorative nav">
    <svg class="wave" preserveAspectRatio="none" aria-hidden="true"></svg>
    <nav class="circle-nav" aria-label="Primary navigation (desktop)">
      <button class="circle-btn" data-label="Home"
              data-href="{{ '/' | relative_url }}"></button>
      <button class="circle-btn" data-label="Preparing"
              data-href="{{ '/preparing.html' | relative_url }}"></button>
      <button class="circle-btn" data-label="Reporting"
              data-href="{{ '/reporting.html' | relative_url }}"></button>
      <button class="circle-btn" data-label="Surveys"
              data-href="{{ '/surveys.html' | relative_url }}"></button>
      <button class="circle-btn" data-label="Contact"
              data-href="mailto:anthrosafetywarrior@gmail.com"></button>
    </nav>
  </section>

  <!-- Existing dropdown bar (mobile/fallback) -->
  <div class="nav-scroller">
    <nav class="main-nav">
      <div class="dropdown"><a href="{{ '/' | relative_url }}">Home</a></div>

      <div class="dropdown">
        <a href="{{ '/preparing.html' | relative_url }}">Preparing for Fieldwork</a>
        <div class="dropdown-content">
          <a href="https://docs.google.com/spreadsheets/d/1ZjhKX9xpNuL4AG_rvhCvbrSp2nIuF4NTJd0CaRwR53U/edit?usp=sharing" target="_blank" rel="noopener">Pre-Fieldwork Safety Checklist</a>
        </div>
      </div>

      <div class="dropdown">
        <a href="{{ '/reporting.html' | relative_url }}">Reporting & Resources</a>
        <div class="dropdown-content">
          <a href="{{ '/statelaw.html'          | relative_url }}">USA Laws by State</a>
          <a href="{{ '/internationallaw.html'  | relative_url }}">International Laws by Country</a>
          <a href="{{ '/titleIX.html'           | relative_url }}">Title IX Reporting by University</a>
          <a href="{{ '/fundingethics.html'     | relative_url }}">Funding Agencies &amp; Professional Associations Reporting</a>
        </div>
      </div>

      <div class="dropdown">
        <a href="{{ '/surveys.html' | relative_url }}">Anonymous Surveys</a>
        <div class="dropdown-content">
          <a href="https://forms.gle/YjAmqWd9xDC5WCJk8" target="_blank" rel="noopener">Fieldwork Misconduct Survey</a>
          <a href="https://forms.gle/9DjrMVNP2oUu1GDD8" target="_blank" rel="noopener">Website Feedback Survey</a>
        </div>
      </div>

      <div class="dropdown"><a href="mailto:anthrosafetywarrior@gmail.com">Contact Us</a></div>
    </nav>
  </div>

  <main>
    {{ content }}
  </main>

  <!-- Dropdown hover/portal logic (unchanged) -->
  <script>
    (function () {
      const clamp = (v, min, max) => Math.max(min, Math.min(max, v));
      const canHover = window.matchMedia('(hover: hover) and (pointer: fine)').matches;

      document.querySelectorAll('.dropdown').forEach(drop => {
        const btn   = drop.querySelector(':scope > a');
        const panel = drop.querySelector('.dropdown-content');
        if (!btn || !panel) return;

        const usePortal = !canHover;
        let placeholder = null;
        let isOpen = false;

        const moveToBody = () => {
          if (!usePortal || panel.parentElement === document.body) return;
          placeholder = document.createElement('span');
          placeholder.hidden = true;
          drop.appendChild(placeholder);
          document.body.appendChild(panel);
        };
        const moveBack = () => {
          if (!usePortal || !placeholder) return;
          placeholder.replaceWith(panel);
          placeholder = null;
        };

        function positionPanel(){
          if (!isOpen) return;
          const r = btn.getBoundingClientRect();
          const margin = 12;
          const minW = 220;
          const maxW = Math.min(320, window.innerWidth - margin*2);
          const width = clamp(Math.max(r.width, minW), minW, maxW);

          let left = r.left + (r.width/2) - (width/2);
          left = clamp(left, margin, window.innerWidth - margin - width);

          panel.style.width = width + 'px';
          panel.style.left  = Math.round(left) + 'px';
          panel.style.top   = Math.round(r.bottom) + 'px';
        }

        function show(){
          if (isOpen) return;
          moveToBody();
          panel.classList.add('is-floating');
          panel.style.display = 'block';
          isOpen = true;
          positionPanel();
          window.addEventListener('scroll', positionPanel, { passive: true });
          window.addEventListener('resize', positionPanel);
        }

        function hide(){
          if (!isOpen) return;
          panel.style.display = 'none';
          panel.classList.remove('is-floating');
          panel.style.width = panel.style.left = panel.style.top = '';
          isOpen = false;
          window.removeEventListener('scroll', positionPanel);
          window.removeEventListener('resize', positionPanel);
          moveBack();
        }

        if (window.PointerEvent) {
          drop.addEventListener('pointerenter', show);
          drop.addEventListener('pointerleave', hide);
        } else {
          drop.addEventListener('mouseenter', show);
          drop.addEventListener('mouseleave', hide);
        }
        btn.addEventListener('focus', show);
        btn.addEventListener('blur', hide);

        if (!canHover) {
          let armed = false;
          btn.addEventListener('click', (e) => {
            if (!armed) {
              e.preventDefault(); show(); armed = true; setTimeout(() => armed = false, 1200);
            }
          });
          document.addEventListener('click', (e) => {
            if (!drop.contains(e.target) && !panel.contains(e.target)) hide();
          }, { passive: true });
        }
        btn.addEventListener('keydown', (e)=>{ if (e.key === 'Escape') hide(); });
      });
    })();
  </script>

  <!-- Sticky shadow on scroll for mobile bar -->
  <script>
    const nav = document.querySelector('.nav-scroller');
    if (nav){
      const onScroll = () => nav.classList.toggle('is-stuck', window.scrollY > 0);
      onScroll(); window.addEventListener('scroll', onScroll, {passive:true});
    }
  </script>

  <!-- Draw 5-cycle sine + place circle buttons at troughs -->
  <script>
    (() => {
      const wrap = document.querySelector('.wave-nav');
      const svg  = wrap?.querySelector('svg.wave');
      const btns = wrap?.querySelectorAll('.circle-btn') || [];
      if (!wrap || !svg || !btns.length) return;

     const WAVES = 5;        // keep 5 troughs
const AMPFR = 0.24;     // was 0.35 â†’ shallower wave
const BASE  = 0.46;     // was 0.55 â†’ lifts the whole wave up a bit
const FILL1 = '#7a4a60';
const DROP  = 0;        // we won't drop below; weâ€™ll *inset* inside the trough

      function draw(){
        const W = svg.clientWidth  || svg.getBoundingClientRect().width;
        const H = svg.clientHeight || svg.getBoundingClientRect().height;
        const A = AMPFR * H;
        const k = 2*Math.PI*WAVES / W;
        const phi = 0;

        // build fill path
        const N = 200;
        let d = `M 0 ${BASE*H + A*Math.sin(phi)}`;
        for (let i=1;i<=N;i++){
          const x = (i/N)*W;
          const y = BASE*H + A*Math.sin(k*x + phi);
          d += ` L ${x} ${y}`;
        }
        d += ` L ${W} ${H} L 0 ${H} Z`;

        svg.innerHTML = '';
        const p = document.createElementNS('http://www.w3.org/2000/svg','path');
        p.setAttribute('d', d);
        p.setAttribute('fill', FILL1);
        svg.appendChild(p);

     // troughs at 3Ï€/2 + 2Ï€n
const pad = Math.max(40, W*0.03);

[...btns].forEach((btn, n) => {
  const theta = 1.5*Math.PI + 2*Math.PI*n;   // 3Ï€/2 + 2Ï€n
  let x = theta / (2*Math.PI*WAVES / W);     // x = theta / k
  x = Math.max(pad, Math.min(W - pad, x));

  const yCurve = BASE*H + (AMPFR*H)*Math.sin((2*Math.PI*WAVES / W)*x);

  const size = btn.offsetWidth || parseFloat(getComputedStyle(btn).width);

  // inset upward from the lowest point so the circle sits *within* the trough
  const inset = Math.min((AMPFR*H)*0.65, size*0.6); // stay comfortably inside
  const cx = x - size/2;
  const cy = yCurve - inset - size/2;

  btn.style.left = `${cx}px`;
  btn.style.top  = `${cy}px`;

  // accessibility labels (keep the circle visually empty)
  btn.setAttribute('aria-label', btn.dataset.label);
  btn.setAttribute('title', btn.dataset.label);
});
  </script>
</body>
</html>
